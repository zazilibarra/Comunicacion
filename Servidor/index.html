<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script
    src="https://code.jquery.com/jquery-3.5.1.js"
    integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
    crossorigin="anonymous"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <script src="https://kit.fontawesome.com/6328ae3068.js" crossorigin="anonymous"></script>
    <title>Index</title>
</head>
<body>
    <h1>CENTRO DE CONTROL</h1>
    <h2>SENSORES ACTIVOS: </h2>
    <br>
    <ul id="lista-sensores" class="list-group">
        <li class="list-group-item active">Sensor de Linea
            <span id="sensor1" class="font-weight-bold"><strong></strong></span>
        </li>
        <li class="list-group-item">Sensor de sonido
            <span class="font-weight-bold"><strong>27.4 dB</strong></span>
        </li>
        <li class="list-group-item">Puerta Principal
            <span class="font-weight-bold"><strong>ABIERTA</strong></span>
        </li>
        <li class="list-group-item">Ventana Sala
            <span class="font-weight-bold"><strong>CERRADA</strong></span>
        </li>
        <li class="list-group-item">Detector de calor
            <span class="font-weight-bold"><strong>SEGURO</strong></span>
        </li>
      </ul>

      <script>

          function repeat(){
              setInterval(updateSensores,3000);
          }

          function updateSensores(){
            $.ajax('http:192.168.1.71:8080/getinfo', 
            {
                dataType: 'json', // type of response data
                success: function (data,status,xhr) {   // success callback function
                    $('#lista-sensores').html("");
                    data.forEach(element => {
                        let liElem = "";
                        let id = element.id;
                        let value = element.value;
                        liElem = '<li class="list-group-item">'+ id +'<span><strong> '+ value  +'</strong></span></li>';
                        $("#lista-sensores").append(liElem);
                    });
                    console.log("NEW SENSOR UPDATE...");
                },
                error: function (jqXhr, textStatus, errorMessage) { // error callback 
                    console.log("Error");
                }
            });
          }
          
          repeat();
          

      </script>

</body>
</html>